{{ define "main" }}
<!-- tpl: projects-list v3 -->
<main class="content projects">
  <h1>Projects</h1>

  {{/* Only regular pages in this section */}}
  {{ $pages := .RegularPages }}

  {{/* Split: archived true vs everything else (false or unset) */}}
  {{ $archived := where $pages "Params.archived" "==" true }}
  {{ $active   := where $pages "Params.archived" "!=" true }}

  <section>
    <h2>Active</h2>
    {{ range ($active.ByWeight) }}
      <article class="project">
        <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
        {{ with .Params.status }}<span class="badge">{{ . }}</span>{{ end }}
        {{ with .Summary }}<p>{{ . }}</p>{{ end }}
        <p><a href="{{ .RelPermalink }}">→</a></p>
      </article>
      <hr>
    {{ else }}
      <p>No active projects yet.</p>
    {{ end }}
  </section>

  <section>
    <h2>Archived</h2>
    {{ range ($archived.ByWeight) }}
      <article class="project archived">
        <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
        {{ with .Summary }}<p>{{ . }}</p>{{ end }}
        <p><a href="{{ .RelPermalink }}">→</a></p>
      </article>
      <hr>
    {{ else }}
      <p>No archived projects.</p>
    {{ end }}
  </section>
</main>
{{ end }}
