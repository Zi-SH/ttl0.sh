{{ define "main" }}
<main class="content">
  <div class="projects-grid">
    <article class="projects-main">
      {{ $pages := .RegularPages }}
      {{ $active   := where $pages "Params.archived" "!=" true }}
      {{ $archived := where $pages "Params.archived" "==" true }}

      <section>
        <h2>Active</h2>
        {{ range ($active.ByWeight) }}
          {{ $id := .File.TranslationBaseName | default (anchorize .Title) }}
          <article class="project" id="{{ $id }}">
            <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
            {{ with .Summary }}<p>{{ . }}</p>{{ end }}
            <p class="more"><a href="{{ .RelPermalink }}">Read more &rarr;</a></p>
          </article>
          <hr>
        {{ else }}
          <p>No active projects yet.</p>
        {{ end }}
      </section>

      {{ if gt (len $archived) 0 }}
      <section>
        <h2>Archived</h2>
        {{ range ($archived.ByWeight) }}
          {{ $id := .File.TranslationBaseName | default (anchorize .Title) }}
          <article class="project archived" id="{{ $id }}">
            <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
            {{ with .Summary }}<p>{{ . }}</p>{{ end }}
            <p class="more"><a href="{{ .RelPermalink }}">Read more &rarr;</a></p>
          </article>
          <hr>
        {{ end }}
      </section>
      {{ end }}
    </article>

    <aside class="projects-aside">
      <h3>All Projects</h3>
      <ul class="projects-nav">
        {{ range ($active.ByWeight) }}
          {{ $id := .File.TranslationBaseName | default (anchorize .Title) }}
          <li><a href="#{{ $id }}">{{ .Title }}</a></li>
        {{ end }}
        {{ if gt (len $archived) 0 }}
          <li class="divider">Archived</li>
          {{ range ($archived.ByWeight) }}
            {{ $id := .File.TranslationBaseName | default (anchorize .Title) }}
            <li class="archived"><a href="#{{ $id }}">{{ .Title }}</a></li>
          {{ end }}
        {{ end }}
      </ul>
    </aside>
  </div>
</main>
{{ end }}